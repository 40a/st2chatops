#!/bin/sh

set -e

fail() {
    echo "$1"
    echo "See README.md for more information"
    exit 1
}

HERE=$(dirname $(dirname "$(readlink -f "$0")"))

export PATH="$HERE/node_modules/.bin:$HERE/node_modules/hubot/node_modules/.bin:$PATH"

. $HERE/st2chatops.env

# Ensure proper ENV variables are set
if [ ! -n "$HUBOT_ADAPTER" ]; then
   fail "Must provide HUBOT_ADAPTER ENV variable to start."
fi

if [ ! -n "$HUBOT_NAME" ]; then
    fail "Must provide HUBOT_NAME to start"
fi

if [ ! -n "$HUBOT_ALIAS" ]; then
    fail "Must provide HUBOT_ALIAS to start"
fi

exec $HERE/node_modules/.bin/hubot "@"
